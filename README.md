```sql
BEGIN
  -- Loop over all test launches with REGRESSION = '0'
  FOR launch_record IN (
    SELECT ID FROM QAPORTAL.TEST_LAUNCH WHERE REGRESSION = '0'
  ) LOOP

    -- Delete TEST_STEP_RUNs linked to this launch
    DELETE FROM QAPORTAL.TEST_STEP_RUN
    WHERE TEST_RUN_ID IN (
      SELECT ID FROM QAPORTAL.TEST_RUN
      WHERE TEST_LAUNCH_ID = launch_record.ID
    );

    -- Delete TEST_RUNs
    DELETE FROM QAPORTAL.TEST_RUN
    WHERE TEST_LAUNCH_ID = launch_record.ID;

    -- Delete TEST_PARAMs
    DELETE FROM QAPORTAL.TEST_PARAM
    WHERE TEST_LAUNCH_ID = launch_record.ID;

    -- Delete TEST_TAGs
    DELETE FROM QAPORTAL.TEST_TAG
    WHERE TEST_LAUNCH_ID = launch_record.ID;

    -- Delete PERFORMANCE_METRICS
    DELETE FROM QAPORTAL.PERFORMANCE_METRICS
    WHERE TEST_LAUNCH_ID = launch_record.ID;

    -- Delete TEST_LAUNCH
    DELETE FROM QAPORTAL.TEST_LAUNCH
    WHERE ID = launch_record.ID;

  END LOOP;

  -- Delete orphaned TEST_STEP_RUNs
  DELETE FROM QAPORTAL.TEST_STEP_RUN r
  WHERE EXISTS (
    SELECT 1
    FROM QAPORTAL.TEST_STEP s
    WHERE r.TEST_STEP_ID = s.ID
      AND NOT EXISTS (
        SELECT 1 FROM QAPORTAL.TEST_RUN WHERE TEST_ID = s.TEST_ID
        UNION
        SELECT 1 FROM QAPORTAL.TEST_PARAM WHERE TEST_ID = s.TEST_ID
        UNION
        SELECT 1 FROM QAPORTAL.TEST_TAG WHERE TEST_ID = s.TEST_ID
      )
  );

  -- Delete orphaned TEST_STEPs
  DELETE FROM QAPORTAL.TEST_STEP s
  WHERE NOT EXISTS (
    SELECT 1 FROM QAPORTAL.TEST_RUN WHERE TEST_ID = s.TEST_ID
    UNION
    SELECT 1 FROM QAPORTAL.TEST_PARAM WHERE TEST_ID = s.TEST_ID
    UNION
    SELECT 1 FROM QAPORTAL.TEST_TAG WHERE TEST_ID = s.TEST_ID
  );

  -- Delete orphaned TESTs
  DELETE FROM QAPORTAL.TEST t
  WHERE NOT EXISTS (
    SELECT 1 FROM QAPORTAL.TEST_RUN WHERE TEST_ID = t.ID
    UNION
    SELECT 1 FROM QAPORTAL.TEST_PARAM WHERE TEST_ID = t.ID
    UNION
    SELECT 1 FROM QAPORTAL.TEST_TAG WHERE TEST_ID = t.ID
  );

  -- Delete orphaned TEST_CLASSes
  DELETE FROM QAPORTAL.TEST_CLASS c
  WHERE NOT EXISTS (
    SELECT 1 FROM QAPORTAL.TEST WHERE TEST_CLASS_ID = c.ID
  );

  -- Delete orphaned TEST_FEATUREs
  DELETE FROM QAPORTAL.TEST_FEATURE f
  WHERE NOT EXISTS (
    SELECT 1 FROM QAPORTAL.TEST WHERE TEST_FEATURE_ID = f.ID
  );

  -- Delete orphaned FIXes
  DELETE FROM QAPORTAL.FIX
  WHERE ID NOT IN (
    SELECT FIX_ID FROM QAPORTAL.TEST_RUN WHERE FIX_ID IS NOT NULL
    UNION
    SELECT FIX_ID FROM QAPORTAL.TEST_STEP_RUN WHERE FIX_ID IS NOT NULL
  );

  -- Delete orphaned LOGs
  DELETE FROM QAPORTAL.LOG
  WHERE ID NOT IN (
    SELECT LOG_ID FROM QAPORTAL.TEST_RUN WHERE LOG_ID IS NOT NULL
    UNION
    SELECT LOG_ID FROM QAPORTAL.TEST_STEP_RUN WHERE LOG_ID IS NOT NULL
  );

  -- Delete orphaned EXCEPTIONS
  DELETE FROM QAPORTAL.EXCEPTION
  WHERE ID NOT IN (
    SELECT EXCEPTION_ID FROM QAPORTAL.TEST_RUN WHERE EXCEPTION_ID IS NOT NULL
    UNION
    SELECT EXCEPTION_ID FROM QAPORTAL.TEST_STEP_RUN WHERE EXCEPTION_ID IS NOT NULL
  );

END;
/
```
